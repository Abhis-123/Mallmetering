<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: superadmin/components/meters/LinkedMeters.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: superadmin/components/meters/LinkedMeters.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { Component } from "react";
import {
  Container,
  Row
} from "shards-react";
import axios from "axios";
import GlobalContext from "../../state/GlobalContext";
import { Redirect } from "react-router-dom";
import Delete from '@material-ui/icons/Delete';
import Edit from '@material-ui/icons/Edit';
import MUIDataTable from "mui-datatables";
import CustomToolbar from "./CustomToolbar"
class Meters extends Component {
  static contextType = GlobalContext;
  constructor(props) {
    super(props);
    this.state = {
      previtabledata: [],
      tableheadings: ["Meter Name","url", "Working","Linked","Edit","Delete"],
      tabledata: [],
      columns: [
        {
          name:"meter_name",
          label:"Meter Name", options:{ filter:true, sort:true}
        },
        {
          name:"url",
          label:"Url", options:{ filter:true, sort:true}

        },{
            name:"linked",label:"Linked", options:{ filter:true, sort:true}
        },
          {
            name:"edit",
            label:"Edit", options:{ filter:false, sort:false}
          }
          ,
          {
            name:"delete",
            label:"Delete", options:{ filter:false, sort:false}
          }
    ],
    data: [],
      mode: "",
      rows:"",

      options:{

        selectableRowsHideCheckboxes: true,
        responsive:"horizontal",
        customToolbar: () => {
          return (
            &lt;CustomToolbar />
          );
        }
      },
    };
    this.componentDidMount = this.componentDidMount.bind(this);
  }



  componentDidMount() {
    axios.get(axios.defaults.baseURL + "/superadmin/meters/?operation=get")
      .then(res =>{
        let data= []
          res.data.map(row => {
            if(row.linked){
              data.push({
                meter_name:row.meter_name,
                url:row.meter_url,
                linked:row.linked===true?"yes":"no",
                edit : () => &lt;div style={{cursor:"pointer"}} onClick={()=>(this.EditMeter(row))}> &lt;Edit/>&lt;/div>,
                delete :() => &lt;div style={{cursor:"pointer"}} onClick={()=>(this.delete(row.id))}>
                &lt;Delete/>
               &lt;/div>
              })
            }
            return row
          })
          this.setState({ 
            data:data
          })

      })
      .catch(error => console.log(error.response));
  }

  delete(id) {
    axios.delete(axios.defaults.baseURL +"/superadmin/meters/?operation=delete&amp;id=" + id).then(res => {
      if (res.status===200 || res.status===204){
        window.alert("deleted customer");
        this.setState({
          updated:id,
        },this.fetchcustomers())
      }
    }).catch(err => {
      console.log(err);
    })
    
}

/**
* 
* @param {*} row 
* @returns redirect to /editmeter
*/
EditMeter(row) {
const action = this.context
this.setState({
  mode:"editmeter", 
  row:row
},() => {
  action("set", {
    key: "operation",
    value: {
      operation: "editmeter",
      data: row
    }
  })
})
}
  render() {
    if(this.state.mode==="editmeter"){
      return (
        &lt;Redirect to="/meters/editmeter" />
      )
    }


    
    return (
      &lt;Container fluid className="main-content-container px-4 mt-3">
        &lt;Row>
        &lt;MUIDataTable
                      title="Meters List"
                      data={this.state.data}
                      columns={this.state.columns}
                      options={this.state.options}
                    />

        &lt;/Row>
      &lt;/Container>
    );
  }
}

export default Meters;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Mon Jul 05 2021 22:26:56 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
